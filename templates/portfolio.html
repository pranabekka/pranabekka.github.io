{% extends "base.html" %}

{% block title %}
{{ page.title }} - {{ config.title | markdown | striptags }}
{% endblock %}

{% block content %}

<h1>{{ page.title }}</h1>

<p class="subtitle">
  Created: {{ page.date | date(format="%Y-%m-%d") }}
  {%- if page.updated | date(format="%Y-%m-%d") != page.date | date(format="%Y-%m-%d") -%}
    <br>
    Last Updated: {{ page.updated | date(format="%Y-%m-%d") }}
  {%- endif -%}
</p>

{{ page.content | safe }}

<h2>Online Projects</h2>

<p>The projects I've published on the site.</p>
<p><strong>NOTE:</strong>
Most of the projects are still in the PDF (as of Oct 2023).</p>

<div class="folio-grid">

  {# sort and filter backlinks #}
  {% set sorted_backlinks = [] %}
  {% for backlink in page.backlinks %}
    {% set basename = backlink.permalink | split(pat="/") | nth(n=3) %}
    {% if basename != "drafts" %}
      {% set name = basename ~ ".md" %}
      {% set backlink_page = get_page(path=name) %}
      {% set_global sorted_backlinks =
        sorted_backlinks | concat(with=backlink_page.date ~ "/" ~ name) %}
    {% endif %}
  {% endfor %}

  {% for backlink in sorted_backlinks | sort | reverse %}
    {% set name = backlink | split(pat="/") | last %}
    {% set backlink_page = get_page(path=name) %}
    <a href="{{ backlink_page.permalink }}">
      <img src="{{ config.base_url }}/{{ backlink_page.extra.thumb }}">
      {{ backlink_page.title }}
    </a>
  {% endfor %}

</div>

{% endblock content %}
