<!DOCTYPE html>
<html lang="en">

<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="https:&#x2F;&#x2F;pranabekka.github.io/style.css">
  <link rel="icon" href="https:&#x2F;&#x2F;pranabekka.github.io/favicon.svg?v=2">
  <link rel="me" href="https://mastodon.social/@pranabekka">
  <link type="application/atom+xml" rel="alternate" href="https:&#x2F;&#x2F;pranabekka.github.io/atom.xml" title="Pranab&#x27;s site">
  <title>
Static Site Build Tool
 - Pranabâ€™s site

</title>
</head>

<body>
  <main>
      

<h1>Static Site Build Tool
</h1>


<p class="subtitle">
  On
  <img src="/favicon.svg" id="icon">
  <a href=https:&#x2F;&#x2F;pranabekka.github.io>
    Pranabâ€™s site

  </a>
</p>

<p class="subtitle">
  
    Apr 20, 2023
    
      <svg role="img" aria-label="to (right arrow)"
           class="icon" xmlns="http://www.w3.org/2000/svg" fill="none" viewBox="0 0 24 24" stroke-width="1.5" stroke="currentColor" class="w-6 h-6">
        <title>to</title>
        <desc>right arrow</desc>
        <path stroke-linecap="round" stroke-linejoin="round" d="M13.5 4.5 21 12m0 0-7.5 7.5M21 12H3" />
      </svg>
      Oct 29, 2023
    (IST)
  
</p>



  <details class="contents">
    <summary>Show/Hide contents</summary>
    <ol>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#prior-art">Prior Art</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#templating">Templating</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#build-tools">Build Tools</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#authoring">Authoring</a>
        
          <ol>
            
              <li>
                <a href="https://pranabekka.github.io/static-site-build-tool/#front-matter">Front Matter</a>
              </li>
            
          </ol>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#content-layout">Content Layout</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#development-and-testing">Development and Testing</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#image-optimisation">Image Optimisation</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#content-templates">Content Templates</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#html-processing">HTML Processing</a>
        
      </li>
    
      <li>
        <a href="https://pranabekka.github.io/static-site-build-tool/#documentation-and-help">Documentation and Help</a>
        
      </li>
    
    </ol>
  </details>

<hr>

<p>Iâ€™ve just been thinking of what it would be like
to have a static site build script.
You would have
dependency management,
parallelisation,
task runners/commands,
and access to all sorts of (cli) tools
(including your own scripts and binaries).</p>
<p><strong>EDIT:</strong> <a href="https://soupault.app">soupault.app</a>
might be the way to go.
It lets you run any cli tool
and use it in your site building,
as well as a few other cool things.</p>
<h2 id="prior-art">Prior Art<a class="zola-anchor" href="#prior-art" aria-label="Anchor link for: prior-art">ðŸ”—</a></h2>
<p>Some similar tools already exist
in the form of <a href="https://mkws.sh">mkws.sh</a>
and <a href="https://github.com/kmaasrud/sss">sss</a> (inspired by mkws), 
but my idea is a bit different â€”
you use a build tool to stitch everything together,
as opposed to a shell script,
which can easily track which files need to be rebuilt,
gives you simple commands to run,
can (usually) easily perform parallel computation,
and is quite easy to extend.
Plus, I discovered you can use python as the shell in make.
And I wouldnâ€™t really want to use <a href="https://adi.onl/pp.html">pp</a> â€”
itâ€™s a bit cumbersome.</p>
<h2 id="templating">Templating<a class="zola-anchor" href="#templating" aria-label="Anchor link for: templating">ðŸ”—</a></h2>
<p>Iâ€™d prefer it if pp used a cleaner syntax like <code>{{ shell }}</code>,
which makes inlining so much cleaner,
and it handles indenting better as well,
which some file formats really care about.
Iâ€™d also like to have the option to customise which shell to use,
since Iâ€™m more familiar with fish shell â€”
there is absolutely no reason to use (d)ash for a personal site.
Update: turns out itâ€™s quite easy to make your own
<a href="https://pranabekka.github.io/shell-templating/">templating engine in fish shell</a>!</p>
<p>Otherwise, you could always use
a cli templating engine like <a href="https://github.com/kolypto/j2cli">j2cli</a>.</p>
<p>Going through the Pop!_OS package repository,
there are a lot of cli html templating engines,
such as ace, amber, cl-lml2, and aft.</p>
<h2 id="build-tools">Build Tools<a class="zola-anchor" href="#build-tools" aria-label="Anchor link for: build-tools">ðŸ”—</a></h2>
<p>The build tool can also be anything that you like â€”
I like something like make, <a href="https://gittup.org/tup/">tup</a> or <a href="https://pranabekka.github.io/static-site-build-tool/the-apenwarr-link">redo</a>
since they integrate with the shell pretty well,
and thereâ€™s a lot of file management in there,
plus the shell makes excellent glue code.
Otherwise you could use something like
<a href="https://mesonbuild.com">meson/ninja</a> or <a href="https://shakebuild.com">shake</a>,
if you want something <em>really</em> powerful.
Actually, shake might be a good bet if you know haskell,
since (I think) you can plug in other libraries for each step,
to make a much more cohesive and well-integrated program.
Thereâ€™s even <a href="https://github.com/ruricolist/overlord">overlord</a> for a (common) lisp build system,
or <a href="https://buck2.build/">buck2</a> if you want somethind industrial grade<sup>TM</sup>
(thatâ€™s a joke).</p>
<p><strong>NOTE:</strong> If youâ€™re using make,
the <code>.ONESHELL</code> directive runs the steps in a command
in the same shell instance,
otherwise make runs each one in a separate shell.</p>
<h2 id="authoring">Authoring<a class="zola-anchor" href="#authoring" aria-label="Anchor link for: authoring">ðŸ”—</a></h2>
<p>You can use any file format you want for authoring,
including the dialect of whatever markup language you choose.
Some interesting languages are <a href="https://typst.app">typst</a> and <a href="https://github.com/jgm/djot">djot</a>,
although typst doesnâ€™t have HTML output yet
(as of the time of writing this article;
if you look at the design of typst, the pdf output,
and the github issues, however,
you can be sure that itâ€™ll be really solid).
I used to really like [asciidoc][asciidoc],
but the tooling around it is a bit limited,
so you need to know ruby/java to extend it,
which is why I didnâ€™t get around to having a blog for bloody ages.
Use a common static site generator if this is your first time,
and read through the docs, examples and discussion â€”
you can do almost anything you want and more.
It might help to start with a test blog,
where you just write down random thoughts and articles,
without actually deploying it anywhere.
Anyway, rant aside, the point is that
thereâ€™s some really cool markup languages out there.</p>
<h3 id="front-matter">Front Matter<a class="zola-anchor" href="#front-matter" aria-label="Anchor link for: front-matter">ðŸ”—</a></h3>
<p>You could use a different front matter format,
or no front matter at all!
Let your site builder handle the rest automatically!
Maybe read it out from the file system.
Maybe with a git hook that gets dates from git.
Maybe some other step that creates file hashes
and stores dates in a db?
Maybe a prompt for metainformation about unknown files
that gets saved in a db.</p>
<h2 id="content-layout">Content Layout<a class="zola-anchor" href="#content-layout" aria-label="Anchor link for: content-layout">ðŸ”—</a></h2>
<p>You could adopt a structure where
you dump everything into the content directory,
and if thereâ€™s a build step for that file (type)
it gets processed according to the build step,
else itâ€™s copied directly to the build directory.</p>
<p>Some (most?) build systems even prioritise specificity
when it comes to applying a build step,
so you can set certain files
(or classes of files, based on the file name)
to use custom processing/templating.
You could just rely on ordering, otherwise â€”
simply place the more specific ones higher up,
and the files it doesnâ€™t match will get passed along
to the more general rules,
while the ones you want to treat specially
are caught by the more specific rule at the top.</p>
<h2 id="development-and-testing">Development and Testing<a class="zola-anchor" href="#development-and-testing" aria-label="Anchor link for: development-and-testing">ðŸ”—</a></h2>
<p>For serving the pages live while you develop and test,
you can plug in something like <a href="https://github.com/svenstaro/miniserve">miniserve</a>
(to serve files on your device and local network),
with <a href="https://eradman.com/entrproject">entr</a> (to automatically rebuild on file change)
and <a href="https://livejs.com">live.js</a>
(injected into your html pages for auto-reload).</p>
<p>Youâ€™ll need to set up your site builder
to use relative paths
or set the url to be the local ip
used by miniserve <sup class="footnote-reference"><a href="#mini-ip">1</a></sup> or your preferred dev server
in order to preview the links locally,
otherwise it would take you to your production site.</p>
<div class="footnote-definition" id="mini-ip"><sup class="footnote-definition-label">1</sup>
<p>miniserve displays a list of ips,
but you could also find out by running
<code>ifconfig | grep 192</code>.
If you use <code>ifconfig</code> use the second ip
starting with <code>192.168</code> and add <code>:8080</code> at the end.
miniserve tends to use 8080,
but you might need to change it if it says something else.</p>
</div>
<p>You could even use <a href="https://caddyserver.com/">caddy</a>
or some other server thing.
Thereâ€™s actually plenty of them â€”
especially in the Go and Rust space.
You can even use a python one-liner â€”
I <em>think</em> itâ€™s <code>python3 -m http.server</code>.</p>
<p>In fact, caddy seems to have markdown rendering
and template evaluation.
Dang.
That makes a great development environment,
although it might be a bit overkill,
and it will probably cause some config duplication.</p>
<p>Alternatively, you could write your own tool to
create a file server that works as expected â€”
it would automatically serve index.html files from directories,
and edit the base url in internal pages
to point to the local network.</p>
<h2 id="image-optimisation">Image Optimisation<a class="zola-anchor" href="#image-optimisation" aria-label="Anchor link for: image-optimisation">ðŸ”—</a></h2>
<p>You can add build steps for most images,
where they are optimised for file size
and converted to multiple (display) sizes.
Multiple display sizes directly affect resolution
and therefore the final file size,
and the browser can often decide which one to pick
if you simply list all of them in a figure tag
(or something like that).</p>
<p>Using this entire system gives you the freedom
to plug in all sorts of things
and create a system that aligns with your workflow,
instead of tying you to the assumptions
(such as markdown authoring)
of the static site generator.</p>
<p>You will, of course, have to edit your templates
to use the processed images.
You can use <code>srcset</code> attributes in <code>img</code> tags,
or use a figure element,
and the browser will automatically pick
the most appropriate image.</p>
<p>See the mdn web docs
<a href="https://developer.mozilla.org/en-US/docs/Learn/HTML/Multimedia_and_embedding/Responsive_images">article on responsive images</a>
for a comprehensive guide.</p>
<p>CSS-Tricks also has a great
<a href="https://css-tricks.com/a-guide-to-the-responsive-images-syntax-in-html/#using-srcset">article on reponsive images</a>.</p>
<h2 id="content-templates">Content Templates<a class="zola-anchor" href="#content-templates" aria-label="Anchor link for: content-templates">ðŸ”—</a></h2>
<p>You can make content file templates
that you can instantiate with a simple <code>new</code> command.
This is especially useful
if youâ€™re using custom front matter or special pages,
which you might forget about.
For example, if youâ€™re authoring files in markdown,
then you could store some template markdown files,
like blog.md and tutorial.md,
and then use <code>build-tool new blog</code>
or <code>build-tool new tutorial</code>
to create a new post using the given template.</p>
<h2 id="html-processing">HTML Processing<a class="zola-anchor" href="#html-processing" aria-label="Anchor link for: html-processing">ðŸ”—</a></h2>
<p>You might want to edit the generated HTML for your pages,
even to a small degree where you replace a span with a div,
or the other way around.</p>
<p>One tool Iâ€™ve found <a href="http://xmlstar.sourceforge.net">xmlstarlet</a>,
which can structurally edit xml files,
and has some amount of praise around the internet.</p>
<p>Alternatively, xml2 <sup class="footnote-reference"><a href="#xml2">2</a></sup> converts XML/HTML to line-oriented formats
that can be manipulated with the usual Unix tools,
which frankly sounds exciting.
(A very similar tool for json is <a href="https://github.com/tomnomnom/gron">gron</a>.
You should check it out if you already know the unix tools.)
Additionally, a github user called dbohdan maintains a list of
<a href="https://github.com/dbohdan/structured-text-tools#xml-html">structured text tools</a>,
which includes some xml tools that could be useful.</p>
<div class="footnote-definition" id="xml2"><sup class="footnote-definition-label">2</sup>
<p>See xml2 in the Ubuntu package repositories.
Website available on <a href="https://pranabekka.github.io/static-site-build-tool/web.archive.org/web/20160719191401/http://ofb.net/~egnor/xml2">archive.org</a>.</p>
</div>
<p>You could also use a mardown converter
that lets you hook into itâ€™s HTML generator
and create custom HTML output.
I donâ€™t know of any such tool yet,
but it could expose the parts of the structure as variables,
which you could feed into a template.</p>
<h2 id="documentation-and-help">Documentation and Help<a class="zola-anchor" href="#documentation-and-help" aria-label="Anchor link for: documentation-and-help">ðŸ”—</a></h2>
<p>Getting this method to really work for people
would require some good documentation and examples to accompany it,
because itâ€™s all about customisability and control,
which will require a lot of research and experimentation
that could prohibit people from developing the site they want
if the information is not available up front.
This includes
a list of tools,
how to use them,
best practices,
common issues,
a public forum or chat (like Zulip <sup class="footnote-reference"><a href="#zulip">3</a></sup>),
and more.</p>
<div class="footnote-definition" id="zulip"><sup class="footnote-definition-label">3</sup>
<p>Zulip allows you to make some chats
visible to everyone on the internet,
regardless of whether theyâ€™re signed up
and part of your organisation or not.
I believe this is a very important step for
reducing friction for new users.
See the <a href="https://oilshell.org">oilshell/oils-for-unix</a> project
for an example.</p>
</div>
<p>A good documentation project around this system
should allow anyone to easily create their own site builder
in a programming language of their choice
(except, perhaps, for a good parallel build system).
And then they could contribute further to the documentation.
Maybe.
Is there a general website
covering different static site generators
and how they work?
That might be the place for such documentation.
Maybe link to good shell scripting practices as well.</p>






  
  
    
    
    
  




  <hr>
  <p>References to this page:</p>
  <ul>
  
    
    
    <li>
      <a href="https:&#x2F;&#x2F;pranabekka.github.io&#x2F;shell-templating&#x2F;">DIY (Fish) Shell Templating</a>
    </li>
  
  </ul>



  </main>
  <footer>
    <nav>
      <a href="https:&#x2F;&#x2F;pranabekka.github.io/about#contact">Feedback</a>
      <a href="https:&#x2F;&#x2F;pranabekka.github.io">Home</a>
      <a href="#">Go to top â†‘</a>
      
<a href="https://github.com/pranabekka/pranabekka.github.io/blob/main/content&#x2F;static-site-build-tool.md">
  Page source
</a>

    </nav>
  </footer>
</body>

</html>
